---
layout: default
title: 9.1.1 Installation Issues
nav_order: 2
parent: Installation Issues
---

# Installation Issues
{: .no_toc }

Installation Issues
{: .fs-5 .fw-300 }

## Table of contents
{: .no_toc}

1. TOC
{:toc}

---

## How to use this document

[This article](https://buoctrenmay.com/2019/04/06/sitecore-xp-9-1-update-1-step-by-step-install-guide-on-your-machine/) will show you step by step how to install Sitecore, follow that and when you face issues you can come here and search for them. 
It's a long list of issues that faced me and my collegues, hopfully you can find help here ðŸ˜Š.

## Issues

### Get-JavaKeytool : The term 'Get-JavaKeytool' is not recognized
`Problem`{: .label .label-red .fs-3 }

    PS D:\sc911_install2> .\9.1_install-solr.ps1
    Import-Module : The specified module 'D:\sc911_install2\helper.psm1' was not loaded because no valid module file was
    found in any module directory.
    At D:\sc911_install2\9.1_install-solr.ps1:35 char:2

    Import-Module "$PSScriptRoot\helper.psm1"

    CategoryInfo          : ResourceUnavailable: (D:\sc911_install2\helper.psm1:String) [Import-Module], FileNotFoun
    dException

    FullyQualifiedErrorId : Modules_ModuleNotFound,Microsoft.PowerShell.Commands.ImportModuleCommand

    Get-JavaKeytool : The term 'Get-JavaKeytool' is not recognized as the name of a cmdlet, function, script file, or
    operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and try
    again.
    At D:\sc911_install2\9.1_install-solr.ps1:43 char:13

    $keytool = Get-JavaKeytool -JavaMinVersionRequired $JavaMinVersio ...

    CategoryInfo          : ObjectNotFound: (Get-JavaKeytool:String) [], ParentContainsErrorRecordException

    FullyQualifiedErrorId : CommandNotFoundException


`Solution`{: .label .label-green .fs-3 }

Make sure to put the helper script in the same path as the installation script and change the helper script to helper.psm1


### Could not complete request for https://solr:8983/solr 

`Problem`{: .label .label-red .fs-3 }

    When:
    PS D:\sc911_install> .\sc91_install.ps1
    ...
    Install-SitecoreConfiguration : Could not complete request for https://solr:8983/solr - The remote name could not be resolved: 'solr'
    At D:\sc911_install\sc91_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:01:03
    Invoke-ManageSolrCoreTask : Could not complete request for https://solr:8983/solr - The remote name could not be resolved: 'solr'
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.2.0\Public\Install-SitecoreConfiguration.ps1:641 char:25

                & $entry.Task.Command @paramSet | Out-Default

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Invoke-ManageSolrCoreTask

`Solution`{: .label .label-green .fs-3 }

Make sure you installed solr and you updated the parameter $SolrUrl = "https://localhost:8984/solr" in the file sc91_install.ps1



###  Unable to parse [resolvepath(parameter('XConnectXP0_Package'))]

`Problem`{: .label .label-red .fs-3 }

    [-------------------------------------------------------------------- XConnectXP0_InstallWDP : WebDeploy ---------------------------------------------------------------------------------]
    Install-SitecoreConfiguration : Unable to parse [resolvepath(parameter('XConnectXP0_Package'))] - Exception calling "InvokeWithContext" with "2" argument(s): "Cannot bind argument to
    parameter 'Path' because it is an empty string."
    At D:\sc911_install\sc91_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException   + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:00:38
    GetConfigFunctionResult : Unable to parse [resolvepath(parameter('XConnectXP0_Package'))] - Exception calling "InvokeWithContext" with "2" argument(s): "Cannot bind argument to parameter
    'Path' because it is an empty string."
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.2.0\Private\JsonConfiguration.ps1:226 char:20

    ...      return GetConfigFunctionResult -FunctionText $InputObject -Param ...

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,GetConfigFunctionResult


`Solution`{: .label .label-green .fs-3 }

Override the json files as mentioned in the article


### File system path 'identityserver.local' is not valid.

`Problem`{: .label .label-red .fs-3 }

    [----------------------------------------------------------------- IdentityServer_InstallWDP : WebDeploy ---------------------------------------------------------------------------------]
    [WebDeploy]:[Path] C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe
    msdeploy.exe : Error: File system path 'identityserver.local' is not valid. Only absolute paths are supported.
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Tasks\Invoke-CommandTask.ps1:31 char:13

    & $Path $Arguments | Out-Default

    CategoryInfo          : NotSpecified: (Error: File sys... are supported.:String) [], RemoteException

    FullyQualifiedErrorId : NativeCommandError

    Error count: 1.
    Install-SitecoreConfiguration : Command C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe returned a non-zero exit code - (-1)
    At D:\sc911_install\sc91_install.ps1:79 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:00:13
    Invoke-CommandTask : Command C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe returned a non-zero exit code - (-1)
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Tasks\Invoke-WebDeployTask.ps1:36 char:2

    Invoke-CommandTask -Path $Path -Arguments $msdeployArgs -TaskName ...

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Invoke-CommandTask

`Solution`{: .label .label-green .fs-3 }

Review the parameter InstallDirectory, itâ€™s not set or has a problem.


### Failed to start service 'Sitecore XConnect Search Indexer 

`Problem`{: .label .label-red .fs-3 }

    Failed to start service 'Sitecore XConnect Search Indexer - xconnect.local-IndexWorker

    Things to check:
    try to run C:\inetpub\wwwroot\xconnect.local\App_Data\jobs\continuous\IndexWorker> .\XConnectSearchIndexer.exe
    It will tell you why it's not working

`Solution`{: .label .label-green .fs-3 }

Check the license file


### You must remove all users with password before setting the containment property 

`Problem`{: .label .label-red .fs-3 }

    Info: Updating database: Running.
    Info: Updating database (Start)
    msdeploy.exe : Error: .Net SqlClient Data Provider: Msg 12809, Level 16, State 1, Line 5 You must remove all users with password before setting the containment property to NONE.
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Tasks\Invoke-CommandTask.ps1:31 char:13

        & $Path $Arguments | Out-Default

    CategoryInfo          : NotSpecified: (Error: .Net Sql...operty to NONE.:String) [], RemoteException

    FullyQualifiedErrorId : NativeCommandError

    Error: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = N
    ONE
    WITH ROLLBACK IMMEDIATE;
    END
    Error: .Net SqlClient Data Provider: Msg 5069, Level 16, State 1, Line 5 ALTER DATABASE statement failed.
    Error: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = N
    ONE
    WITH ROLLBACK IMMEDIATE;
    END
    Info: An error occurred while the batch was being executed.


`Solution`{: .label .label-green .fs-3 }
    
Uncomment Uninstall-SitecoreConfiguration to remove everything and install again.


### Failed to start service Sitecore Marketing Automation Engine 

`Problem`{: .label .label-red .fs-3 }

    Install-SitecoreConfiguration : Failed to start service 'Sitecore Marketing Automation Engine - xconnect.local-MarketingAutomationService
    (xconnect.local-MarketingAutomationService)'.
    At D:\sc911_install\sc91_install.ps1:79 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:04:37
    Start-Service : Failed to start service 'Sitecore Marketing Automation Engine - xconnect.local-MarketingAutomationService
    (xconnect.local-MarketingAutomationService)'.
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Tasks\Invoke-ManageServiceTask.ps1:40 char:33

                $instance | Start-Service

    CategoryInfo          : OpenError: (System.ServiceProcess.ServiceController:ServiceController) [Start-Service], ServiceCommandException

    FullyQualifiedErrorId : StartServiceFailed,Microsoft.PowerShell.Commands.StartServiceCommand

    Sub Problem:

    if you run the
    PS C:\inetpub\wwwroot\xconnect.local\App_Data\jobs\continuous\AutomationEngine> .\maengine.exe

    you uwill get the next error
    Starting Marketing Automation Engine...
    2020-03-16 13:51:21 ERR Error initializing XConnect client.
    System.AggregateException: One or more errors occurred. ---> Sitecore.XConnect.XdbCollectionUnavailableException: The HTTP response was not successful: Forbidden
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.XConnectClientConfiguration.<InitializeAsync>d__32.MoveNext()
    --- End of inner exception stack trace ---
    at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
    at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
    at Sitecore.XConnect.Client.Configuration.XConnect.Extensions.ServiceCollectionExtensions.<>c__DisplayClass1_0.<UseXConnectClientConfiguration>b__0(IServiceProvider provider)
    ---> (Inner Exception #0) Sitecore.XConnect.XdbCollectionUnavailableException: The HTTP response was not successful: Forbidden
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.XConnectClientConfiguration.<InitializeAsync>d__32.MoveNext()<---
    ERROR
    System.InvalidOperationException: This configuration has not been initialized. Please call the initialize method before using it.
    at Sitecore.XConnect.Client.XConnectClientConfiguration.CheckInitialized()
    at Sitecore.XConnect.Client.XConnectClientConfiguration.get_CurrentModel()
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Sitecore.XConnect.Configuration.Extensions.<>c__DisplayClass24_0.<UseServiceDecorator>b__1(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitTransient(TransientCallSite transientCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
    at Sitecore.Xdb.MarketingAutomation.Engine.App.ServiceConfiguration.get_Engine()
    at Sitecore.Xdb.MarketingAutomation.Engine.App.Program.RunAsConsoleApp()


`Solution`{: .label .label-green .fs-3 }

All of the next might or might not help:
Get the currnet Cert:
Get-Childitem cert:\LocalMachine\root -Recurse | 
    Where-Object {$.Issuer -ne $.Subject}

Reset it:
Get-Childitem cert:\LocalMachine\root -Recurse | 

Where-Object {$.Issuer -ne $.Subject} | 
    Move-Item -Destination Cert:\LocalMachine\CA

while($True){
Start-Sleep -Seconds 1.5
Write-Host "Resetting!"
Get-Childitem cert:\LocalMachine\root -Recurse | 
    Where-Object {$.Issuer -ne $.Subject} | 
    Move-Item -Destination Cert:\LocalMachine\CA
}

PS: cd cert:\
PS Cert:> Get-ChildItem -Path 'D6CCBD87325F9D49D6A746DEECD5A5B5B4E2DB39' -Recurse

manually

Open mmc for

current user and

local computer

Remove any sitecore certificate except the SIF certificate

specially if in the name "DO_NOT_TRUst"

remove all certificates from personal folder of the local computer

Remove the folder c:\certificates

Uninstall-SitecoreConfiguration (uninstall everything)

comment install and uncomment uninstall in the sc911_install.ps1 file

Install-SitecoreConfiguration (install again)

Be very careful or you will get your machine resetted if you deleted the woring cert 



### Install-SitecoreConfiguration : NotFound - https://localhost:8984/solr

`Problem`{: .label .label-red .fs-3 }

    [---------------------------- XConnectSolr_CreateCores [1] : ManageSolrCore ------------------------------------------]
    [XConnectSolr_CreateCores [1]]:[Requesting] https://localhost:8984/solr/
    [XConnectSolr_CreateCores [1]]:[SolrCore] Performing Create on https://localhost:8984/solr/

    Install-SitecoreConfiguration : NotFound -
    https://localhost:8984/solr//admin/cores?action=Create&name=sc91_xdb&property.update.autoCreateFields=false&wt=json
    At D:\sc911_install2\sc911_install\sc911_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:00:41
    Invoke-ManageSolrCoreTask : NotFound -
    https://localhost:8984/solr//admin/cores?action=Create&name=sc91_xdb&property.update.autoCreateFields=false&wt=json
    At C:\Program
    Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Install-SitecoreConfiguration.ps1:641 char:25

                    & $entry.Task.Command @paramSet | Out-Default

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Invoke-ManageSolrCoreTask

`Solution`{: .label .label-green .fs-3 }

Don't put `/` at the end of $SolrUrl = "https://localhost:8984/solr"



### Failed to start service 'Sitecore Marketing Automation Engine

`Problem`{: .label .label-red .fs-3 }

    [--------------------------- XConnectXP0_StartServices [2] : ManageService -------------------------------------------]
    [XConnectXP0_StartServices [2]]:[Updating] sc91.xconnect.local-MarketingAutomationService
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    WARNING: Waiting for service 'Sitecore Marketing Automation Engine - sc91.xconnect.local-MarketingAutomationService
    WARNING: (sc91.xconnect.local-MarketingAutomationService)' to start...
    Install-SitecoreConfiguration : Failed to start service 'Sitecore Marketing Automation Engine -
    sc91.xconnect.local-MarketingAutomationService (sc91.xconnect.local-MarketingAutomationService)'.
    At D:\sc911_install2\sc911_install\sc911_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:05:25
    Start-Service : Failed to start service 'Sitecore Marketing Automation Engine -
    sc91.xconnect.local-MarketingAutomationService (sc91.xconnect.local-MarketingAutomationService)'.
    At C:\Program
    Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Tasks\Invoke-ManageServiceTask.ps1:40 char:33

                $instance | Start-Service

    CategoryInfo          : OpenError: (System.ServiceProcess.ServiceController:ServiceController) [Start-Service],
    ServiceCommandException

    FullyQualifiedErrorId : StartServiceFailed,Microsoft.PowerShell.Commands.StartServiceCommand

    PS D:\sc911_install2\sc911_install>

    PS C:\inetpub\wwwroot\sc91.xconnect.local\App_Data\jobs\continuous\AutomationEngine> .\maengine.exe

    Starting Marketing Automation Engine...
    2020-09-18 11:08:20 ERR Error initializing XConnect client.
    System.AggregateException: One or more errors occurred. ---> Sitecore.XConnect.XdbCollectionUnavailableException: The HTTP response was not successful: Forbidden
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.XConnectClientConfiguration.<InitializeAsync>d__32.MoveNext()
    --- End of inner exception stack trace ---
    at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
    at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
    at Sitecore.XConnect.Client.Configuration.XConnect.Extensions.ServiceCollectionExtensions.<>c__DisplayClass1_0.<UseXConnectClientConfiguration>b__0(IServiceProvider provider)
    ---> (Inner Exception #0) Sitecore.XConnect.XdbCollectionUnavailableException: The HTTP response was not successful: Forbidden
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.XConnectClientConfiguration.<InitializeAsync>d__32.MoveNext()<---
    ERROR
    System.InvalidOperationException: This configuration has not been initialized. Please call the initialize method before using it.
    at Sitecore.XConnect.Client.XConnectClientConfiguration.CheckInitialized()
    at Sitecore.XConnect.Client.XConnectClientConfiguration.get_CurrentModel()
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Sitecore.XConnect.Configuration.Extensions.<>c__DisplayClass24_0.<UseServiceDecorator>b__1(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitTransient(TransientCallSite transientCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
    at Sitecore.Xdb.MarketingAutomation.Engine.App.ServiceConfiguration.get_Engine()
    at Sitecore.Xdb.MarketingAutomation.Engine.App.Program.RunAsConsoleApp()

    PS C:\inetpub\wwwroot\sc91.xconnect.local\App_Data\jobs\continuous\AutomationEngine>


`Solution`{: .label .label-green .fs-3 }


Sometimes removing the certificates alone doesn't help, you have to change AllowInvalidClientCertificates to true. But it's tricky while you are installing, cand changing it in the wdp zip will corrupt the zip file.
to solve this you can execute the next two loops in ceperate powershell windows.
make sure to change the instance name

    while($True){
    Start-Sleep -Seconds 1.0
    $url = "C:\inetpub\wwwroot\sc91.xconnect.local\App_Config\AppSettings.config"

    if(!(Test-Path -Path $url))
    {
        Write-Host "not yet!"
        Continue
    }

    [xml]$myXML = Get-Content $url
    $node = $myXML.appSettings.add | where {$_.key -eq "AllowInvalidClientCertificates"}
    $node.value = "true"
    $myXML.Save($url)

    Write-Host "updated!" 	

    }

---

    while($True){
    Start-Sleep -Seconds 1.0
    $url = "C:\inetpub\wwwroot\sc91.xconnect.local\App_Data\jobs\continuous\AutomationEngine\App_Config\AppSettings.config"
    if(!(Test-Path -Path $url))
    {
    Write-Host "not yet!"
    Continue
    }

    [xml]$myXML = Get-Content $url
    $node = $myXML.appSettings.add | where {$_.key -eq "AllowInvalidClientCertificates"}
    $node.value = "true"
    $myXML.Save($url)

    Write-Host "updated!" 	

    }



### You must remove all users with password before setting the containment 

`Problem`{: .label .label-red .fs-3 }

    [---------------------------------- XConnectXP0_InstallWDP : WebDeploy -----------------------------------------------]
    [WebDeploy]:[Path] C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe
    Info: Adding MsDeploy.Site (MsDeploy.Site).
    Info: Adding database (user id=sa;data source=5CD9471N72;initial catalog=sc91_Processing.Pools)
    Info: Initializing deployment: Pending.
    Info: Analyzing deployment plan: Pending.
    Info: Updating database: Pending.
    Info: Creating deployment plan: Pending.
    Info: Verifying deployment plan: Pending.
    Info: Deploying package to database: Pending.
    Info: Creating deployment plan: Running.
    Info: Initializing deployment: Running.
    Info: Initializing deployment (Start)
    Warning: The compatibility level of the target schema 150 is not supported, which may result in undefined behavior. Plea
    se upgrade to a later version which supports this compatibility level.
    Warning: The database containment option has been changed to None.  This may result in deployment failure if the state o
    f the database is not compliant with this containment level.
    Info: Initializing deployment: Completed.
    Info: Initializing deployment (Complete)
    Info: Creating deployment plan: Completed.
    Info: Verifying deployment plan: Running.
    Info: Analyzing deployment plan: Running.
    Info: Analyzing deployment plan (Start)
    Info: Analyzing deployment plan: Completed.
    Info: Analyzing deployment plan (Complete)
    Info: Verifying deployment plan: Completed.
    Info: Deploying package to database: Running.
    Info: Updating database: Running.
    Info: Updating database (Start)
    msdeploy.exe : Error: .Net SqlClient Data Provider: Msg 12809, Level 16, State 1, Line 5 You must remove all users
    with password before setting the containment property to NONE.
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Tasks\Invoke-CommandTask.ps1:31
    char:13

        & $Path $Arguments | Out-Default

    CategoryInfo          : NotSpecified: (Error: .Net Sql...operty to NONE.:String) [], RemoteException

    FullyQualifiedErrorId : NativeCommandError

    Error: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = NONE
    WITH ROLLBACK IMMEDIATE;
    END
    Error: .Net SqlClient Data Provider: Msg 5069, Level 16, State 1, Line 5 ALTER DATABASE statement failed.
    Error: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = NONE
    WITH ROLLBACK IMMEDIATE;
    END
    Info: An error occurred while the batch was being executed.
    Info: Updating database: Faulted.
    Info: Updating database (Failed)
    Info: Deploying package to database: Faulted.
    Error Code: ERROR_EXECUTING_METHOD
    More Information: Could not deploy package.
    Warning SQL72020: The compatibility level of the target schema 150 is not supported, which may result in undefined
    behavior. Please upgrade to a later version which supports this compatibility level.
    Warning SQL72023: The database containment option has been changed to None.  This may result in deployment failure if
    the state of the database is not compliant with this containment level.
    Error SQL72014: .Net SqlClient Data Provider: Msg 12809, Level 16, State 1, Line 5 You must remove all users with
    password before setting the containment property to NONE.
    Error SQL72045: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = NONE
    WITH ROLLBACK IMMEDIATE;
    END
    Error SQL72014: .Net SqlClient Data Provider: Msg 5069, Level 16, State 1, Line 5 ALTER DATABASE statement failed.
    Error SQL72045: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = NONE
    WITH ROLLBACK IMMEDIATE;
    END
    Learn more at: http://go.microsoft.com/fwlink/?LinkId=221672#ERROR_EXECUTING_METHOD.
    Error: Could not deploy package.
    Warning SQL72020: The compatibility level of the target schema 150 is not supported, which may result in undefined
    behavior. Please upgrade to a later version which supports this compatibility level.
    Warning SQL72023: The database containment option has been changed to None.  This may result in deployment failure if
    the state of the database is not compliant with this containment level.
    Error SQL72014: .Net SqlClient Data Provider: Msg 12809, Level 16, State 1, Line 5 You must remove all users with
    password before setting the containment property to NONE.
    Error SQL72045: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = NONE
    WITH ROLLBACK IMMEDIATE;
    END
    Error SQL72014: .Net SqlClient Data Provider: Msg 5069, Level 16, State 1, Line 5 ALTER DATABASE statement failed.
    Error SQL72045: Script execution error.  The executed script:
    IF EXISTS (SELECT 1
    FROM   [master].[dbo].[sysdatabases]
    WHERE  [name] = N'$(DatabaseName)')
    BEGIN
    ALTER DATABASE [$(DatabaseName)]
    SET CONTAINMENT = NONE
    WITH ROLLBACK IMMEDIATE;
    END
    Error count: 1.
    Install-SitecoreConfiguration : Command C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe returned a non-zero
    exit code - (-1)
    At D:\sc911_install2\sc911_install\sc911_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:01:02
    Invoke-CommandTask : Command C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe returned a non-zero exit code -
    (-1)
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Tasks\Invoke-WebDeployTask.ps1:36
    char:2

    Invoke-CommandTask -Path $Path -Arguments $msdeployArgs -TaskName ...

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Invoke-CommandTask



`Solution`{: .label .label-green .fs-3 }

- Uninstall-SitecoreConfiguration (uninstall everything)
    - comment install and uncomment uninstall in the sc911_install.ps1 file
- Install-SitecoreConfiguration (install again)


### Could not complete request for https://solr:8983/solr 

`Problem`{: .label .label-red .fs-3 }

    [---------------------------- XConnectSolr_CreateCores [1] : ManageSolrCore ------------------------------------------]
    [XConnectSolr_CreateCores [1]]:[Requesting] https://localhost:8984/solr
    WARNING: [1/5] Request Failed: The underlying connection was closed: Could not establish trust relationship for the
    SSL/TLS
    WARNING: secure channel.
    [XConnectSolr_CreateCores [1]]:[Requesting] https://localhost:8984/solr
    WARNING: [2/5] Request Failed: The underlying connection was closed: Could not establish trust relationship for the
    SSL/TLS
    WARNING: secure channel.
    [XConnectSolr_CreateCores [1]]:[Requesting] https://localhost:8984/solr
    WARNING: [3/5] Request Failed: The underlying connection was closed: Could not establish trust relationship for the
    SSL/TLS
    WARNING: secure channel.
    [XConnectSolr_CreateCores [1]]:[Requesting] https://localhost:8984/solr
    WARNING: [4/5] Request Failed: The underlying connection was closed: Could not establish trust relationship for the
    SSL/TLS
    WARNING: secure channel.
    [XConnectSolr_CreateCores [1]]:[Requesting] https://localhost:8984/solr
    WARNING: [5/5] Request Failed: The underlying connection was closed: Could not establish trust relationship for the
    SSL/TLS
    WARNING: secure channel.
    Install-SitecoreConfiguration : Could not complete request for https://localhost:8984/solr - The underlying connection
    was closed: Could not establish trust relationship for the SSL/TLS secure channel.
    At D:\sc911_install2\sc911_install\sc911_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:00:37
    Invoke-ManageSolrCoreTask : Could not complete request for https://localhost:8984/solr - The underlying connection was
    closed: Could not establish trust relationship for the SSL/TLS secure channel.
    At C:\Program
    Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.1.0\Public\Install-SitecoreConfiguration.ps1:641 char:25

                & $entry.Task.Command @paramSet | Out-Default

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Invoke-ManageSolrCoreTask

    PS D:\sc911_install2\sc911_install>

when you check solr url in the browser, it's working fine


`Solution`{: .label .label-green .fs-3 }

Run 9.1_install-solr.ps1 again


### keytool.exe

`Problem`{: .label .label-red .fs-3 }

    keytool.exe not on path. Enter path to keytool (found in JRE bin folder):

`Solution`{: .label .label-green .fs-3 }

Install JAVA JRE

### No registration found for extension 'AppPool' of type 'Task'

`Problem`{: .label .label-red .fs-3 }

    PS D:\sc911_install2\sc911_install> .\sc911_install.ps1
    ************************************
    Sitecore Install Framework
    Version - 2.3.0
    ************************************

    WorkingDirectory       : D:\sc911_install2\sc911_install
    WhatIf                 : False
    Verbose                : SilentlyContinue
    Configuration          : D:\sc911_install2\sc911_install\XP0-SingleDeveloper.json
    Debug                  : SilentlyContinue
    AutoRegisterExtensions : False
    WarningAction          : Continue
    ErrorAction            : Stop
    InformationAction      : Continue

    Install-SitecoreConfiguration : No registration found for extension 'AppPool' of type 'Task'.
    At D:\sc911_install2\sc911_install\sc911_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:00:01
    MapTasks : No registration found for extension 'AppPool' of type 'Task'.
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.3.0\Public\Install-SitecoreConfiguration.ps1:453 char:28

    ... sksConfig = MapTasks -InputObject $rawConfig -TasksToExecute $tasksTo ...

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,MapTasks

    PS D:\sc911_install2\sc911_install>


`Solution`{: .label .label-green .fs-3 }

use "powershell -ExecutionPolicy ByPass " infront of your command


### Please verify the connection information 

`Problem`{: .label .label-red .fs-3 }

    [-------------------------------------------------------------------- XConnectXP0_InstallWDP : WebDeploy ---------------------------------------------------------------------------------]  [WebDeploy]:[Path] C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe                                                                                                                 Info: Adding MsDeploy.Site (MsDeploy.Site).                                                                                                                                                  Info: Adding database (user id=sa2;data source=DESKTOP-C6B90NF;initial catalog=sc91_Processing.Pools)                                                                                        Info: Initializing deployment: Pending.                                                                                                                                                      Info: Analyzing deployment plan: Pending.
    Info: Updating database: Pending.
    Info: Creating deployment plan: Pending.
    Info: Verifying deployment plan: Pending.
    Info: Deploying package to database: Pending.
    Info: Creating deployment plan: Running.
    Info: Initializing deployment: Running.
    Info: Initializing deployment (Start)
    Info: Initializing deployment: Faulted.
    Info: Initializing deployment (Failed)
    Info: Creating deployment plan: Faulted.
    Info: Verifying deployment plan: Faulted.
    Info: Deploying package to database: Faulted.
    msdeploy.exe : Error Code: ERROR_EXECUTING_METHOD
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.3.0\Public\Tasks\Invoke-CommandTask.ps1:31 char:13

        & $Path $Arguments | Out-Default

    CategoryInfo          : NotSpecified: (Error Code: ERROR_EXECUTING_METHOD:String) [], RemoteException

    FullyQualifiedErrorId : NativeCommandError

    More Information: Could not deploy package.
    Unable to connect to target server 'DESKTOP-C6B90NF'. Please verify the connection information such as the server name, login credentials, and firewall rules for the target server.
    Login failed for user 'sa2'.
    Learn more at: https://go.microsoft.com/fwlink/?LinkId=221672#ERROR_EXECUTING_METHOD.
    Error: Could not deploy package.
    Error: Unable to connect to target server 'DESKTOP-C6B90NF'. Please verify the connection information such as the server name, login credentials, and firewall rules for the target server.
    Error: Login failed for user 'sa2'.
    Error count: 1.
    Install-SitecoreConfiguration : Command C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe returned a non-zero exit code - (-1)
    At D:\sc911_install2\sc911_install\sc911_install.ps1:76 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:00:52
    Invoke-CommandTask : Command C:\Program Files\iis\Microsoft Web Deploy V3\msdeploy.exe returned a non-zero exit code - (-1)
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.3.0\Public\Tasks\Invoke-WebDeployTask.ps1:36 char:2

    Invoke-CommandTask -Path $Path -Arguments $msdeployArgs -TaskName ...

    CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException

    FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Invoke-CommandTask

    PS D:\sc911_install2\sc911_install>


`Solution`{: .label .label-green .fs-3 }

Allow remote connections and allow windows and sql authentication



### Failed to start service Sitecore Marketing Automation Engine

`Problem`{: .label .label-red .fs-3 }

    PS C:\inetpub\wwwroot\Habitat.xconnect.local\App_Data\jobs\continuous\AutomationEngine> .\maengine.exe

    Starting Marketing Automation Engine...
    2020-09-28 14:30:32 ERR Error initializing XConnect client.
    System.AggregateException: One or more errors occurred. ---> Sitecore.XConnect.XdbCollectionUnavailableException: An error occurred while sending the request. ---> System.Net.Http.HttpRequestException: An error occurred while sending the request. ---> System.Net.WebException: The remote server returned an error: (407) Proxy Authentication Required.
    at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
    at System.Net.Http.HttpClientHandler.GetResponseCallback(IAsyncResult ar)
    --- End of inner exception stack trace ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.Xdb.Common.Web.CommonWebApiClient1.<ExecuteAsync>d__41.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Sitecore.Xdb.Common.Web.CommonWebApiClient1.<ExecuteGetAsync>d__36.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of inner exception stack trace ---
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.XConnectClientConfiguration.<InitializeAsync>d__32.MoveNext()
    --- End of inner exception stack trace ---
    at System.Threading.Tasks.Task.ThrowIfExceptional(Boolean includeTaskCanceledExceptions)
    at System.Threading.Tasks.Task.Wait(Int32 millisecondsTimeout, CancellationToken cancellationToken)
    at Sitecore.XConnect.Client.Configuration.XConnect.Extensions.ServiceCollectionExtensions.<>c__DisplayClass1_0.<UseXConnectClientConfiguration>b__0(IServiceProvider provider)
    ---> (Inner Exception #0) Sitecore.XConnect.XdbCollectionUnavailableException: An error occurred while sending the request. ---> System.Net.Http.HttpRequestException: An error occurred while sending the request. ---> System.Net.WebException: The remote server returned an error: (407) Proxy Authentication Required.
    at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
    at System.Net.Http.HttpClientHandler.GetResponseCallback(IAsyncResult ar)
    --- End of inner exception stack trace ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.Xdb.Common.Web.CommonWebApiClient1.<ExecuteAsync>d__41.MoveNext() --- End of stack trace from previous location where exception was thrown ---    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)    at Sitecore.Xdb.Common.Web.CommonWebApiClient1.<ExecuteGetAsync>d__36.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of inner exception stack trace ---
    at Sitecore.XConnect.Client.WebApi.ConfigurationWebApiClient.<Refresh>d__4.MoveNext()
    --- End of stack trace from previous location where exception was thrown ---
    at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
    at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
    at Sitecore.XConnect.Client.XConnectClientConfiguration.<InitializeAsync>d__32.MoveNext()<---
    ERROR
    System.InvalidOperationException: This configuration has not been initialized. Please call the initialize method before using it.
    at Sitecore.XConnect.Client.XConnectClientConfiguration.CheckInitialized()
    at Sitecore.XConnect.Client.XConnectClientConfiguration.get_CurrentModel()
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Sitecore.XConnect.Configuration.Extensions.<>c__DisplayClass24_0.<UseServiceDecorator>b__1(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitTransient(TransientCallSite transientCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitIEnumerable(IEnumerableCallSite enumerableCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ConstructorMatcher.CreateInstance(IServiceProvider provider)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass1_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)
    at Sitecore.Xdb.MarketingAutomation.Engine.App.ServiceConfiguration.get_Engine()
    at Sitecore.Xdb.MarketingAutomation.Engine.App.Program.RunAsConsoleApp()

    PS C:\inetpub\wwwroot\Habitat.xconnect.local\App_Data\jobs\continuous\AutomationEngine>


`Solution`{: .label .label-green .fs-3 }

Donâ€™t use the DCOM_User network, instead use DCOM_BYO. Sometimes there is company wide policy in the wifi (network) you are connected to, that will prevent some urls from running. 

### Exception calling "SetAccessRule" with "1" argument(s)

`Problem`{: .label .label-red .fs-3 }

    [------------------------------------------ IdentityServer_SetAppPoolCertStorePermissions : FilePermissions ------------------------------------------------------------------------]
    [IdentityServer_SetAppPoolCertStorePermissions]:[Allow] IIS AppPool\sc10.identityserver
    [IdentityServer_SetAppPoolCertStorePermissions]:[Path] C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys\b0e11d74656c44e3edd4492406aff519_31b9c546-35f6-4fda-9204-91dc6c0008e6
    [IdentityServer_SetAppPoolCertStorePermissions]:[Rights] Read
    [IdentityServer_SetAppPoolCertStorePermissions]:[Inherit] None
    [IdentityServer_SetAppPoolCertStorePermissions]:[Propagate] None
    Install-SitecoreConfiguration : Exception calling "SetAccessRule" with "1" argument(s): "Some or all identity references could not be translated."
    At C:\Users\Mohamed.Abdullah\Downloads\Sitecore 10.0.0 rev. 004346 (WDP XP0 packages) (1)\XP0 Configuration files 10.0.0 rev. 004346\XP0-SingleDeveloper.ps1:77 char:1

    Install-SitecoreConfiguration @singleDeveloperParams *>&1 | Tee-Objec ...

    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException  + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,Install-SitecoreConfiguration

    [TIME] 00:00:11
    Invoke-FilePermissionsTask : Exception calling "SetAccessRule" with "1" argument(s): "Some or all identity references could not be translated."
    At C:\Program Files\WindowsPowerShell\Modules\SitecoreInstallFramework\2.3.0\Public\Install-SitecoreConfiguration.ps1:641 char:25

    & $entry.Task.Command @paramSet | Out-Default

    CategoryInfo          : NotSpecified: (:) [Invoke-FilePermissionsTask], MethodInvocationException

    FullyQualifiedErrorId : IdentityNotMappedException,Invoke-FilePermissionsTask

    PS C:\Users\Mohamed.Abdullah\Downloads\Sitecore 10.0.0 rev. 004346 (WDP XP0 packages) (1)\XP0 Configuration files 10.0.0 rev. 004346>


`Solution`{: .label .label-green .fs-3 }

Update XP0-SingleDeveloper.ps1 file, you can skip any step you want. so just give oermission to everyone in the folder and remove the step (assuming it's a dev installation of course)

    Install-SitecoreConfiguration @singleDeveloperParams -skip IdentityServer_SetAppPoolCertStorePermissions, IdentityServer_SetPermissions, XConnectXP0_SetAppPoolCertStorePermissions, XConnectXP0_SetPermissions, SitecoreXP0_SetPermissions, SitecoreXP0_SetCertStorePermissions *>&1 | Tee-Object XP0-SingleDeveloper.log
